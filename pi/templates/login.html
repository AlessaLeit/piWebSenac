{% load static %}

<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Casa das Pizzas</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/estilo.css' %}">
</head>
  <body>
      <div class="container">
        <!-- Cabeçalho -->
        <header class="header">
          <p>Canoinhas - SC</p>
          <h1>
            <img src="{% static 'logo.jpg' %}" alt="Logo" class="logo">
            Casa das Pizzas
          </h1>
          <p>Entre na sua conta</p>

          <div class="botoes-container">
            <button id="toggle-contrast" class="botao"><i class="fas fa-adjust"></i></button>
            {% if user.is_authenticated %}
              <a href="{% url 'pedido:editar_perfil' %}" class="botao" id="btn-perfil"><i class="fas fa-user"></i></a>
              <a href="{% url 'pedido:logout' %}" class="botao" id="btn-logout"><i class="fas fa-sign-out-alt"></i></a>
            {% else %}
              <a href="{% url 'pedido:selecionar_tamanho' %}" class="botao" id="btn-entrar"><i class="fas fa-home"></i></a>
            {% endif %}
          </div>
        </header>

          <section class="secao-formulario">
              <h2><i class="fas fa-sign-in-alt"></i> Login</h2>
              <form method="post">
                  {% csrf_token %}
                  {% if erro %}
                      <div class="alerta alerta-erro">
                          <i class="fas fa-exclamation-triangle"></i>
                          {{ erro }}
                      </div>
                  {% endif %}
                  <div class="campo-endereco">
                      <label for="id">CPF:</label>
                      <input type="text" id="id" name="id" required oninput="formatCPF(this)" pattern="\d{3}\.\d{3}\.\d{3}-\d{2}" title="Digite um CPF válido no formato XXX.XXX.XXX-XX">
                  </div>
                  <div class="campo-endereco">
                      <label for="senha">Senha:</label>
                      <div class="password-container">
                          <input type="password" id="senha" name="senha" required>
                          <button type="button" id="toggle-password" class="eye-button"><i class="fas fa-eye"></i></button>
                      </div>
                      <a href="{% url 'pedido:resetar_senha' %}" class="link-reset">Esqueci minha senha</a>
                  </div>
                  <button type="submit" class="botao">Entrar</button>
                   <a href="/cadastro" class="botao" id="btn-cadastro">Cadastrar</a>
              </form>
          </section>
      </div>

      <script>
        // Toggle high contrast mode and save preference in localStorage
        const toggleButton = document.getElementById('toggle-contrast');
        const body = document.body;

        function setContrastMode(enabled) {
          if (enabled) {
            body.classList.add('high-contrast');
            localStorage.setItem('highContrast', 'true');
          } else {
            body.classList.remove('high-contrast');
            localStorage.setItem('highContrast', 'false');
          }
        }

        toggleButton.addEventListener('click', () => {
          const isEnabled = body.classList.contains('high-contrast');
          setContrastMode(!isEnabled);
        });

        // On page load, check saved preference
        document.addEventListener('DOMContentLoaded', () => {
          const saved = localStorage.getItem('highContrast');
          if (saved === 'true') {
            setContrastMode(true);
          } else {
            setContrastMode(false);
          }
        });

        // Toggle password visibility
        const togglePasswordButton = document.getElementById('toggle-password');
        const passwordInput = document.getElementById('senha');

        togglePasswordButton.addEventListener('click', () => {
          const type = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
          passwordInput.setAttribute('type', type);
          if (type === 'text') {
            togglePasswordButton.classList.add('visible');
          } else {
            togglePasswordButton.classList.remove('visible');
          }
        });

        // Função para formatar CPF
        function formatCPF(input) {
            let value = input.value.replace(/\D/g, ''); // Remove tudo que não é dígito
            if (value.length <= 11) {
                value = value.replace(/(\d{3})(\d)/, '$1.$2');
                value = value.replace(/(\d{3})\.(\d{3})(\d)/, '$1.$2.$3');
                value = value.replace(/(\d{3})\.(\d{3})\.(\d{3})(\d)/, '$1.$2.$3-$4');
            }
            input.value = value;
        }

      </script>
  </body>
    <footer class="rodape">
      <div class="redes-sociais">
        <a href="https://www.instagram.com/casadaspizzas_oficial?igsh=MTRzdzRmeGwzZTQ0ZA==" target="_blank"><img src="{% static 'instagram.png' %}" alt="Instagram"></a>
        <a href="https://www.facebook.com/Casadaspizza1/" target="_blank"><img src="{% static 'facebook.png'%}" alt="Facebook"></a>
      </div>
      <p class="direitos">TODOS OS DIREITOS RESERVADOS © 2025 CASA DAS PIZZAS</p>
    </footer>
</html>
